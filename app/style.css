@reference "tailwindcss";

@layer utilities {
  .tiptap .ProseMirror:focus {
    outline: none;
  }
}
@layer components {
  /* Tiptap编辑器内容样式 */
  .tiptap {
    @apply leading-relaxed;
  }
  /* 首元素去上边距 */
  .tiptap > :first-child {
    @apply mt-0;
  }

  .ProseMirror:focus {
    outline: none;
  }

  /* 更粗的光标 */
  .tiptap::selection {
    @apply bg-purple-200 dark:bg-purple-700;
  }

  /* 列表 */
  .tiptap ul,
  .tiptap ol {
    @apply pl-4 my-5 mr-1;
    list-style-position: outside;
  }

  .tiptap ul {
    list-style-type: disc;
  }

  .tiptap ol {
    list-style-type: decimal;
  }

  .tiptap li p {
    @apply my-1;
  }

  /* 标题 */
  .tiptap h1,
  .tiptap h2,
  .tiptap h3,
  .tiptap h4,
  .tiptap h5,
  .tiptap h6 {
    @apply leading-tight mt-10;
    font-family: var(--font-serif);
    text-wrap: pretty;
  }

  .tiptap h1,
  .tiptap h2 {
    @apply mt-2 mb-6;
  }

  .tiptap h1 {
    @apply text-2xl font-bold;
  }
  .tiptap h2 {
    @apply text-xl font-semibold;
  }
  .tiptap h3 {
    @apply text-lg font-semibold;
  }
  .tiptap h4,
  .tiptap h5,
  .tiptap h6 {
    @apply text-base font-medium;
  }

  /* 行内代码 */
  .tiptap code {
    @apply bg-purple-100 dark:bg-purple-900/40 text-slate-900 dark:text-slate-100 text-sm px-1 py-0.5 rounded;
  }

  /* 代码块 */
  .tiptap pre {
    @apply bg-slate-900 text-slate-100 rounded-lg my-6 px-4 py-3 overflow-x-auto font-mono text-sm;
  }

  .tiptap pre code {
    @apply bg-transparent p-0 text-inherit;
  }

  /* 引用 */
  .tiptap blockquote {
    @apply border-l-4 border-slate-300 dark:border-slate-600 pl-4 my-6 italic text-slate-600 dark:text-slate-300;
  }

  /* 分割线 */
  .tiptap hr {
    @apply border-0 border-t border-slate-200 dark:border-slate-700 my-8;
  }

  /* MenuBar组件样式 */
  .editor-shell {
    @apply rounded-2xl border shadow-sm overflow-hidden;
    background: var(--card);
    border-color: var(--border);
  }

  .editor-toolbar {
    @apply sticky top-0 z-10 border-b backdrop-blur px-3 py-2;
    background: color-mix(in srgb, var(--card) 95%, transparent);
    border-color: var(--border);
  }

  .editor-toolbar-group {
    @apply flex flex-wrap gap-1;
  }

  .editor-btn {
    @apply inline-flex items-center justify-center rounded-md px-2.5 py-1.5 text-xs font-medium transition;
    background: var(--card-2);
    color: var(--text);
  }

  .editor-icon {
    filter: var(--editor-icon-filter);
  }

  .editor-btn.is-active .editor-icon {
    filter: var(--editor-icon-active-filter);
  }

  .editor-btn:hover {
    background: color-mix(in srgb, var(--card-2) 78%, var(--primary));
  }

  .editor-btn.is-active {
    background: var(--primary);
    color: white;
  }

  .editor-btn:disabled {
    @apply opacity-50 cursor-not-allowed;
  }

  .editor-upload {
    @apply inline-flex items-center;
  }

  .editor-upload-btn {
    @apply inline-flex items-center justify-center rounded-md px-2.5 py-1.5 text-xs font-medium transition;
    background: var(--primary);
    color: white;
  }

  .editor-upload-btn:hover {
    background: color-mix(in srgb, var(--primary) 86%, black);
  }

  .editor-upload-btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 40%, transparent);
  }

  .editor-upload-btn.is-disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .editor-upload-btn--soft {
    background: color-mix(in srgb, var(--primary) 16%, var(--card-2));
    color: var(--text);
    border: 1px solid color-mix(in srgb, var(--primary) 20%, var(--border));
  }

  .editor-upload-btn--soft:hover {
    background: color-mix(in srgb, var(--primary) 24%, var(--card-2));
  }

  .editor-upload-btn--ghost {
    background: transparent;
    color: var(--text);
    border: 1px solid var(--border);
  }

  .editor-upload-btn--ghost:hover {
    background: color-mix(in srgb, var(--card-2) 70%, var(--primary));
  }

  .editor-upload-btn--sm {
    @apply px-2 py-1 text-[11px];
  }

  .editor-upload-btn--md {
    @apply px-2.5 py-1.5 text-xs;
  }

  .editor-upload-btn--lg {
    @apply px-3 py-2 text-sm;
  }

  .editor-upload-icon {
    @apply flex items-center justify-center;
  }

  .editor-upload-content {
    @apply inline-flex items-center gap-1.5;
  }

  .editor-upload-label {
    @apply leading-none;
  }

  .editor-upload-btn--solid .editor-icon {
    filter: var(--editor-icon-active-filter);
  }

  .editor-upload-btn--soft .editor-icon,
  .editor-upload-btn--ghost .editor-icon {
    filter: var(--editor-icon-filter);
  }

  .editor-upload-hint {
    display: none;
  }

  .editor-content {
    @apply relative max-h-120 overflow-auto;
  }

  .editor-loading {
    @apply absolute inset-0 flex items-center justify-center bg-[color-mix(in_srgb,var(--card)_85%,transparent)] backdrop-blur;
  }

  @media (max-width: 768px) {
    .editor-shell {
      @apply rounded-xl;
    }

    .editor-toolbar {
      @apply px-2 py-2;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .editor-toolbar-group {
      @apply flex-nowrap;
      width: max-content;
    }

    .editor-btn {
      @apply px-2 py-1 text-[11px];
    }

    .editor-upload-btn {
      @apply px-2 py-1 text-[11px];
    }

    .editor-content {
      @apply max-h-96;
    }
  }

  .button-group button:disabled {
    @apply opacity-50 cursor-not-allowed;
  }

  /* 目录 */
  .col-group {
    @apply flex flex-col;
  }
  @media (max-width: 540px) {
    .col-group {
      @apply flex-col-reverse;
    }
  }

  /* Sidebar */
  .sidebar {
    @apply border-l border-gray-300 flex-none flex-shrink-0 p-4 w-60 sticky top-0;

    /* Medium screens */
    @media (min-width: 800px) {
      width: 20rem; /* w-80 */
    }

    /* Small screens */
    @media (max-width: 540px) {
      @apply border-b border-l-0 w-full h-auto relative p-6;
    }
  }

  .main {
    @apply flex flex-col w-full h-full overflow-auto;
  }

  .sidebar-options {
    @apply flex flex-col items-start gap-4 sticky top-4 h-full;
  }

  .table-of-contents {
    @apply flex flex-col text-sm gap-1 overflow-auto no-underline;
  }

  .table-of-contents > div {
    border-radius: 0.25rem; /* rounded */
    transition: all 0.2s cubic-bezier(0.65, 0.05, 0.36, 1); /* Tailwind default: transition-all duration-200 ease-[custom] */
  }

  .table-of-contents > div:hover {
    background: color-mix(in srgb, var(--card) 80%, var(--primary));
  }

  .table-of-contents .empty-state {
    color: var(--text-muted);
    @apply select-none;
  }

  .table-of-contents .is-active a {
    color: var(--primary);
  }

  .table-of-contents .is-scrolled-over a {
    color: var(--text-muted);
  }

  .table-of-contents a {
    color: var(--text);
    @apply flex gap-1 no-underline;
  }

  /* Before pseudo-element for item index */
  .table-of-contents a::before {
    content: attr(data-item-index) ".";
    @apply mr-1;
  }
}
